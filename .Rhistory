pdf(file="annotation_heatmap.pdf",
paper="special",
width=20,
height=20
)
library("gplots")
par(oma=c(5,5,5,5))
par(mar = c(6,4,4,16)+0.1)
par(lwd = 6)
palette <- colorRampPalette(c('#f0f3ff','#0033BB'))(10)
profile <- read.table("annotation_matrix.dat", header = TRUE)
profile_mat = as.matrix(profile)
profile_mat
View(profile_mat)
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#Rowv=FALSE,Colv=FALSE,
breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = function(x) hclust(x,method = 'complete'),
distfun = function(x) dist(x,method = 'euclidean'),
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(5,5),
#margin=c(30, 30),
col=palette, cexRow=4, cexCol=4,
density.info="none", trace="none")
hclustfun = function(x) hclust(x,method = 'complete')
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) dist(x, method="euclidean")
cl.row <- hclustfunc(distfunc(profile_mat))
cl.col <- hclustfunc(distfunc(t(profile_mat)))
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
col1 <- brewer.pal(7, "Set1")
#col2 <- brewer.pal(5, "Pastel1")
require(RColorBrewer)
install.packages('RColorBrewer')
require(RColorBrewer)
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
require(RColorBrewer)
col1 <- brewer.pal(7, "Set1")
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
RowSideColors = col1[gr.row],
#Rowv=FALSE,Colv=FALSE,
breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(5,5),
#margin=c(30, 30),
col=palette, cexRow=4, cexCol=4,
density.info="none", trace="none")
setwd("C:/Users/Nok/workspace/oncoIMPACT-annotation/")
library("gplots")
pdf(file="annotation_heatmap.pdf",
paper="special",
width=20,
height=20
)
par(oma=c(5,5,5,5))
par(mar = c(6,4,4,16)+0.1)
par(lwd = 6)
palette <- colorRampPalette(c('#f0f3ff','#0033BB'))(10)
profile <- read.table("annotation_matrix.dat", header = TRUE)
profile_mat = as.matrix(profile)
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) dist(x, method="euclidean")
cl.row <- hclustfunc(distfunc(profile_mat))
cl.col <- hclustfunc(distfunc(t(profile_mat)))
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
require(RColorBrewer)
col1 <- brewer.pal(7, "Set1")
#col2 <- brewer.pal(5, "Pastel1")
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
RowSideColors = col1[gr.row],
#Rowv=FALSE,Colv=FALSE,
breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(5,5),
#margin=c(30, 30),
col=palette, cexRow=4, cexCol=4,
density.info="none", trace="none")
dev.off()
dev.off()
dev.off()
?par
?dist
?cutree
?ColSideColors
?heatmap.2
rep("gray",10)
size(profile_mat)
ncol(profile_mat)
nrow(profile_mat)
rep(1,20)
col=rainbow(n)
col=rainbow(7)
col
for i = 1 to numDataset
i
for 1 to numDataset
for?
?for
''
;
;
rowCol = []
rowCol
rowCol = null
rowCol <- []
rowCol <- c()
col[1]
col[7]
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
numDataset = 7
n = 10
#http://www.r-bloggers.com/color-palettes-in-r/
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
rowCol
setwd("C:/Users/Nok/workspace/oncoIMPACT-annotation/")
library("gplots")
png(file="annotation_heatmap.png",
paper="special",
width=20,
height=20
)
#c(bottom, left, top, right)
par(oma = c(5,5,5,5)) #Outer Margin Area: all sides have 5 lines of space
par(mar = c(5,5,5,5)) #the figure margins
par(lwd = 2)  #The line width
palette <- colorRampPalette(c('#f0f3ff','#0033BB'))(10) #10 colors
#read input
profile <- read.table("annotation_matrix.dat", header = TRUE)
profile_mat = as.matrix(profile)
#set up clustering function
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) dist(x, method="euclidean")
cl.row <- hclustfunc(distfunc(profile_mat))
cl.col <- hclustfunc(distfunc(t(profile_mat)))
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
require(RColorBrewer)
col1 <- brewer.pal(7, "Set1")
#col2 <- brewer.pal(5, "Pastel1")
numDataset = 7
n = 10
#http://www.r-bloggers.com/color-palettes-in-r/
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = col1[gr.row],
RowSideColors = rowCol
#Rowv=FALSE,Colv=FALSE,
#breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(10,25),  #row, column
#cexRow=4, cexCol=4, #The magnification to be used for axis annotation
density.info="none",
trace="none"  #character string indicating whether a solid "trace" line should be drawn
)
dev.off()
pdf(file="annotation_heatmap.pdf",
paper="special",
width=20,
height=20
)
#c(bottom, left, top, right)
par(oma = c(5,5,5,5)) #Outer Margin Area: all sides have 5 lines of space
par(mar = c(5,5,5,5)) #the figure margins
par(lwd = 2)  #The line width
palette <- colorRampPalette(c('#f0f3ff','#0033BB'))(10) #10 colors
#read input
profile <- read.table("annotation_matrix.dat", header = TRUE)
profile_mat = as.matrix(profile)
#set up clustering function
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) dist(x, method="euclidean")
cl.row <- hclustfunc(distfunc(profile_mat))
cl.col <- hclustfunc(distfunc(t(profile_mat)))
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
require(RColorBrewer)
col1 <- brewer.pal(7, "Set1")
#col2 <- brewer.pal(5, "Pastel1")
numDataset = 7
n = 10
#http://www.r-bloggers.com/color-palettes-in-r/
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = col1[gr.row],
RowSideColors = rowCol
#Rowv=FALSE,Colv=FALSE,
#breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(10,25),  #row, column
#cexRow=4, cexCol=4, #The magnification to be used for axis annotation
density.info="none",
trace="none"  #character string indicating whether a solid "trace" line should be drawn
)
dev.off()
dev.off()
dev.off()
pdf(file="annotation_heatmap.pdf",
paper="special",
width=20,
height=20
)
#c(bottom, left, top, right)
par(oma = c(5,5,5,5)) #Outer Margin Area: all sides have 5 lines of space
par(mar = c(5,5,5,5)) #the figure margins
par(lwd = 2)  #The line width
palette <- colorRampPalette(c('#f0f3ff','#0033BB'))(10) #10 colors
#read input
profile <- read.table("annotation_matrix.dat", header = TRUE)
profile_mat = as.matrix(profile)
#set up clustering function
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) dist(x, method="euclidean")
cl.row <- hclustfunc(distfunc(profile_mat))
cl.col <- hclustfunc(distfunc(t(profile_mat)))
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
require(RColorBrewer)
col1 <- brewer.pal(7, "Set1")
#col2 <- brewer.pal(5, "Pastel1")
numDataset = 7
n = 10
#http://www.r-bloggers.com/color-palettes-in-r/
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = col1[gr.row],
RowSideColors = rowCol
#Rowv=FALSE,Colv=FALSE,
#breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(10,25),  #row, column
#cexRow=4, cexCol=4, #The magnification to be used for axis annotation
density.info="none",
trace="none"  #character string indicating whether a solid "trace" line should be drawn
)
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = col1[gr.row],
RowSideColors = rowCol,
#Rowv=FALSE,Colv=FALSE,
#breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(10,25),  #row, column
#cexRow=4, cexCol=4, #The magnification to be used for axis annotation
density.info="none",
trace="none"  #character string indicating whether a solid "trace" line should be drawn
)
nrow(profile_mat)
nrow(rowCol)
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
nrow(rowCol)
rowCol
rowCol <- c()
col = rainbow(numDataset)
for (i in 1:numDataset){
i
rowCol <- c(rowCol, rep(col[i], numDataset))
}
rowCol <- c()
for (i in 1:numDataset){
print i
rowCol <- c(rowCol, rep(col[i], numDataset))
}
rowCol <- c()
for (i in 1:numDataset){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
col
rowCol
for (i in 1:len(col)){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
for (i in 1:length(col)){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
rowCol <- c()
for (i in 1:length(col)){
rowCol <- c(rowCol, rep(col[i], numDataset))
}
rowCol
1:length(col)
col
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:length(col)){
rowCol <- c(rowCol, rep(col[i], n))
}
rowCol
col1 <- brewer.pal(7, "Set1")
dev.off()
dev.off()
pdf(file="annotation_heatmap.pdf",
paper="special",
width=20,
height=20
)
#c(bottom, left, top, right)
par(oma = c(5,5,5,5)) #Outer Margin Area: all sides have 5 lines of space
par(mar = c(5,5,5,5)) #the figure margins
par(lwd = 2)  #The line width
palette <- colorRampPalette(c('#f0f3ff','#0033BB'))(10) #10 colors
#read input
profile <- read.table("annotation_matrix.dat", header = TRUE)
profile_mat = as.matrix(profile)
#set up clustering function
hclustfunc <- function(x) hclust(x, method="complete")
distfunc <- function(x) dist(x, method="euclidean")
cl.row <- hclustfunc(distfunc(profile_mat))
cl.col <- hclustfunc(distfunc(t(profile_mat)))
gr.row <- cutree(cl.row, 7)
#gr.col <- cutree(cl.col, 5)
require(RColorBrewer)
col1 <- brewer.pal(7, "Set1")
#col2 <- brewer.pal(5, "Pastel1")
numDataset = 7
n = 10
#http://www.r-bloggers.com/color-palettes-in-r/
col = rainbow(numDataset)
rowCol <- c()
for (i in 1:length(col)){
rowCol <- c(rowCol, rep(col[i], n))
}
heatmap.2(profile_mat,
main = "",
scale="none",
#For the colors
#ColSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = c("purple","purple","purple","purple","darkblue","darkblue","darkblue","darkred","darkred","darkred"),
#RowSideColors = col1[gr.row],
RowSideColors = rowCol,
#Rowv=FALSE,Colv=FALSE,
#breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), #symbreaks = TRUE,
#key.par=list(mgp=c(1.5, 0.5, 0),
#mar=c(2.5, 2.5, 1, 0)),
#For the tree
dendrogram = "row",
hclustfun = hclustfunc,
distfun = distfunc,
key = FALSE,
#lmat=rbind(c(2),c(3),c(1),c(3)),
#lhei=c(1,1,9,0),
#lwid=c(1)
,
#cellnote=as.matrix(profile_mat),notecol="black",notecex=4,
margins =c(10,25),  #row, column
#cexRow=4, cexCol=4, #The magnification to be used for axis annotation
density.info="none",
trace="none"  #character string indicating whether a solid "trace" line should be drawn
)
dev.off()
#http://www.r-bloggers.com/color-palettes-in-r/
col = terrain.colors(numDataset)
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
source()
dev.off()
dev.off()
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
col = rainbow(numDataset)
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
dev.off()
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
col = rainbow(numDataset)
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
dev.off()
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
dev.off()
n = 15
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
dev.off()
source('C:/Users/Nok/workspace/oncoIMPACT-annotation/pair_wise_intersect_all.R')
